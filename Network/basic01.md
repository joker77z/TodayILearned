> 그림으로 배우는 Http Network Basic을 보고 정리한 글입니다.

# **HTTP프로토콜은 TCP/IP프로토콜 중 하나**

HTTP 프로토콜은 텍스트 전송을위한 프로토콜이었지만 지금은 웹을 넘어 다양하게 사용된다.

HTTP 프로토콜은 TCP/IP프로토콜 중 하나다.

프로토콜이란? 통신을 위해서 지켜야 하는 일종의 약속이다. 서로 다른 하드웨어/운영체제가 통신하기 위해서는 모든 요소에 규칙이 필요하다. 어떻게 상대를 찾고, 어떻게 이야기를 시작하고, 어떤 언어로 이야기 하며, 어떻게 이야기를 종료할지 같은 규칙말이다. 좀 더 자세하게 말하면 다양한 프로토콜들은 케이블 규격, IP주소 지정방법, 떨어진 상대 찾기 위한 방법, 도달하는 순서, 웹을 표시하기 위한 순서 등을 정한다.

<br />

# **TCP/IP란?**

IEEE 802.3, ICMP, TCP, HTTP, FTP, DNS, IP, UDP, PPPoE 뭔가 어디선가 봤던 것들이다. 이런 프로토콜들을 모아서 총칭하는 것이 TCP/IP다. TCP/IP에는 4가지 계층이 있다. 어플리케이션 계층, 트랜스포트 계층, 네트워크 계층, 링크 계층. 계층화 구조로 되어 있기 때문에 사양이 변경되면 해당 계층만 바꾸면 된다. 설계할 때도 구분이 되어있기 때문에 한 개씩 집중적으로 설계할 수 있다.

어플리케이션 계층http, ftp, dns가 여기 속하며 클라이언트에게 제공되는 통신의 움직임을 결정한다.

트랜스포트 계층 어플리케이션 계층에 네트워크로 접속되어 있는 컴퓨터 2대의 데이터 흐름을 제공한다. 서로 다른 성질을 가진 UDP, TCP 두 가지 프로토콜이 있다.

네트워크 계층 (인터넷 계층)패킷의 이동을 다룬다.(전송하는 데이터의 최소 단위) 상대에게 배송하는 길을 선택하는 것.

링크 계층 (데이터 링크 계층, 네트워크 인터페이스 계층)네트워크에 접속하는 하드웨어적인 것을 다룬다.

<br />

# TCP/IP로 통신할 때 흐름

[ 송신 측 ]

1. 클라이언트의 애플리케이션 계층에서 어떤 페이지를 보고 싶다는`요청`
2. 트랜스 포트 계층에서 통신하기 쉽게 조각내서(포트번호 붙이는 등) 네트워크 계층에 전달.
3. 네트워크 계층에서 수신지를 추가해서 링크 계층에 전달 (송신할 준비 완료)

이 때 각 계층을 거치면서 header가 추가된다. http 데이터, TCP헤더, IP헤더, Ethernet 헤더 순이다. 수신 측에서는 각 계층을 거치면서 역순으로 헤더를 제거한다.

<br />

# TCP/IP 중 http와 관계깊은 프로토콜인 IP/TCP/DNS

## 배송을 담당하는 IP

- IP는 계층으로 말하자면 네트워크 층에 해당된다. TCP/IP 중 IP를 담당할 정도로 중요하다.
- IP와 IP 주소는 다르다. IP는 프로토콜이다.
- IP의 역할은 각 패킷을 상대방에게 전달한다. 상대에게 전달하기 위해 여러 요소가 필요하지만 그 중 IP주소, MAC(Media Access Control)주소 요소가 중요하다. IP주소는 각 노드에 부여된 주소이고, MAC주소는 네트워크 카드에 할당된 고유 주소다. IP주소는 변경될 수 있지만, MAC주소는 변경할 수 없다.
- ARP 프로토콜을 사용해서 MAC주소 목적지로 찾아간다.

>  🧑🏻‍💻 IP프로토콜은 ARP 프로토콜(주소 해결하기 위한 프로토콜)을 사용해서 IP주소를 바탕으로 MAC주소를 조사한다.

<br />

## 신뢰성을 담당하는 TCP

- 바이트 스트림 서비스를 이용해서 큰 데이터를 TCP세그먼트라고 하는 단위 패킷으로 분해하여 관리한다.
- 신뢰성 있는 서비스는 상대방에게 보낸다는 뜻이다.

> 🧑🏻‍💻 즉, 큰 용량의 데이터를 작은 패킷으로 쪼개고 보낸 뒤 정확히 도착했는지 확인한다. → 쪼개고 보내고 확인한다.

`three way handshaking`을 이용해서 (1)패킷을 보내고 (2)패킷이 제대로 도착했는지 확인받고 (3)확인했다는 사실을 전달받는다. (1)은 SYN 플래그 / (2)은 SYN/ACK 플래그 / (3)은 ACK플래그를 보낸다.

<br />

## 이름 변환을 담당하는 DNS

도메인 주소로 요청하면 DNS는 ip로 변환해서 제공한다.

<br />

## [정리] IP, TCP, DNS가 http을 이용해서 어떻게 통신할까?

1. 클라이언트는 DNS에게 도메인 주소의 ip를 요청한다.
2. DNS를 통해 알아낸 ip주소로 클라이언트는 데이터를 요청한다. http메세지를 보내는 것
3. 송신 TCP는 http메세지를 패킷으로 분해하고 상대방에게 보낸다. IP는 보내는 패킷을 주소를 찾는다.
4. 수신 TCP는 패킷을 받아서 재조립한다.
5. 요청한 내용을 처리해서 클라이언트에게 반환